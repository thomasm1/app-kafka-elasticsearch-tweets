#spring.profiles.active=${SPRING_PROFILES_ACTIVE:mysql}     # disabled for cloud
spring.jackson.default-property-inclusion= non_null
spring.jackson.serialization.flush-after-write-value=true
spring.jackson.serialization.close-closeable=true
spring.jackson.serialization.fail-on-empty-beans= false
spring.jackson.serialization.write-dates-as-timestamps= false
spring.jackson.deserialization.fail-on-unknown-properties= false
spring.jackson.deserialization.read-date-timestamps-as-nanoseconds= false

spring.main.allow-bean-definition-overriding=true
version=1.2.0
MAPL_API_VERSION=1.0.0
spring.application.name=mapl-app
spring.application.version=1.0.0
info.app.name=MAPL Restful Web Services
info.app.description=MAPL Rest API
info.app.version=1.0.0
info.app.contact.name=Thomas1.maestas@gmail.com
info.app.contact.url=thomasmaestas.net

### Cloud Config
spring.cloud.config.enabled=false
#${app.mapl.client.cloud.config.enabled:false}
spring.cloud.config.import-check.enabled=false
#spring.config.import=optional:configserver:http://localhost:8071

#spring.config.import[0]application-prod.properties
#spring.config.import[1]application-mysql.properties=
#spring.config.import[2]application-cloud.properties
#spring.config.import[3]application-aws.properties
#spring.config.import[4]application-azure.properties
#spring.config.import[5]application-gcp.properties
#spring.config.import[6]application-heroku.properties
#spring.config.import[7]application-digitalocean.properties
spring.config.activate.on-profile=cloud
#management.datadog.metrics.export.apiKey=123

########## Log springframework   ##########
logging.level.org.springframework.web=INFO
logging.level.org.springframework.security=INFO
logging.level.org.springframework.security.web=OFF
logging.level.org.springframework.security.authentication=OFF
logging.level.org.springframework=info
#Show bind values
logging.level.org.hibernate.orm.jdbc.bind=trace
#pre spring boot 3.0.2: logging.level.org.hibernate.type.descriptor.sql=trace
########## Log hibernate SQL statements ##########
logging.level.org.hibernate.cache=info
logging.level.org.hibernate.stat=info
########## Log app/class level ##########
logging.level.com.mapl.app=info
logging.level.com.mapl.app.controller=info

# SQL
spring.sql.init.mode=${app.mapl.client.sql.init.mode}
spring.sql.init.schema-locations=classpath:schema-${app.mapl.client.dbtype}.sql
spring.sql.init.data-locations=classpath:data-${app.mapl.client.dbtype}.sql
spring.sql.init.continue-on-error=true



## ACTUATOR ##health,info,env,metrics,loggers,auditevents,httptrace
spring.data.rest.base-path=/rest/
spring.data.rest.default-page-size=10
spring.data.rest.max-page-size=100
spring.data.rest.page-param-name=page
spring.data.rest.limit-param-name=limit

management.endpoints.web.exposure.include= *
management.endpoint.metrics.enabled=${app.mapl.client.management.endpoint.metrics.enabled:true}
management.info.env.enabled=${app.mapl.client.management.endpoint.metrics.enabled:true}
management.endpoint.health.show-details=always
management.endpoint.shutdown.enabled=true
management.endpoint.health.enabled=true

# UI
spring.mvc.format.date=yyyy-MM-dd
spring.thymeleaf.cache=false
spring.thymeleaf.enabled=true
spring.mvc.view.suffix=.jsp

# Security
security.basic.enabled=true

# File System
spring.servlet.multipart.enabled=true
spring.servlet.multipart.max-file-size= 10MB
spring.servlet.multipart.max-request-size= 10MB
# Email
app.mail.enabled=false
spring.mail.host=${app.mapl.client.mail.host}
spring.mail.port=${app.mapl.client.mail.port}
spring.mail.username=${app.mapl.client.mail.username}
spring.mail.password=${app.mapl.client.mail.password}
spring.mail.properties.mail.smtp.auth=${app.mapl.client.mail.smtp.auth}
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true
spring.mail.properties.mail.smtp.connectiontimeout=5000
spring.mail.properties.mail.smtp.timeout=3000
spring.mail.properties.mail.smtp.writetimeout=5000
spring.mail.properties.mail.smtp.ssl.trust=smtp.gmail.com
spring.mail.properties.mail.mime.charset=UTF-8

#spring.mvc.view.prefix=/view/jsp/
server.port=${app.mapl.server.port}
server.servlet.context-path=/v1
server.context-path=/¸
server.error.path=/user/error
server.error.whitelabel.enabled=false
server.error.include-stacktrace=always
server.error.include-message=always
server.error.include-binding-errors=always
server.error.include-exception=true
server.error.include-path-errors=always
server.error.include-validation-errors=always


# Datasource
spring.datasource.url=${jdbc:${app.mapl.client.dbtype}://${app.mapl.client.database}.${app.mapl.client.host}:${app.mapl.client.port}?createDatabaseIfNotExist=true&allowPublicKeyRetrieval=true&useSSL=false&useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC:H2_VAR}
#spring.datasource.url=jdbc:mysql://localhost:3306/dashboarddb?createDatabaseIfNotExist=true&allowPublicKeyRetrieval=true&useSSL=false&useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
spring.datasource.username=${app.mapl.client.user:sa}
spring.datasource.password=${app.mapl.client.password:w}
spring.datasource.driver-class-name=${app.mapl.client.driver:org.h2.Driver}

## JPA
spring.jpa.generate-ddl=${app.mapl.client.generate-ddl}
spring.jpa.hibernate.ddl-auto=${app.mapl.client.hibernate.ddl-auto}
spring.jpa.database=${app.mapl.client.dbtype:h2}
spring.jpa.database-platform=${app.mapl.client.hibernate.dialect}
spring.jpa.open-in-view=false
spring.jpa.show-sql=true

spring.jpa.properties.hibernate.dialect=${app.mapl.client.hibernate.dialect:org.hibernate.dialect.H2Dialect}
spring.jpa.properties.hibernate.use_sql_comments=true
spring.jpa.properties.hibernate.globally_quoted_identifiers=true
## jpa slow queries ##########
spring.jpa.properties.hibernate.session.events.log.LOG_QUERIES_SLOWER_THAN_MS=1
spring.jpa.properties.hibernate.generate_statistics=true
spring.jpa.properties.hibernate.session.events.log=org.hibernate.event.service.spi.EventListenerRegistry
spring.jpa.properties.jakarta.persistence.validation.mode=none
### CACHE
spring.jpa.properties.jakarta.persistence.sharedCache.mode=ENABLE_SELECTIVE
spring.jpa.properties.jakarta.persistence.cache.storeMode=REFRESH
spring.jpa.properties.jakarta.persistence.cache.retrieveMode=BYPASS

####  H2 Server ###############
H2_VAR=jdbc:h2:mem:testdb;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE;MODE=MYSQL;DATABASE_TO_LOWER=TRUE;CASE_INSENSITIVE_IDENTIFIERS=TRUE;
spring.h2.console.enabled=false
spring.h2.console.path=/h2-console/
spring.h2.console.settings.trace=false
spring.h2.console.settings.web-port=8082
spring.h2.console.settings.web-ssl=false
spring.h2.console.settings.web-allow-others=false
spring.h2.console.settings.web-allow-all=false

## JPA Hibernate

spring.jpa.properties.hibernate.connection.characterEncoding= UTF-8
spring.jpa.properties.hibernate.connection.CharSet= UTF-8
spring.jpa.properties.hibernate.useUnicode=true
spring.jpa.properties.hibernate.show-sql=true
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.jdbc.lob.non_contextual_creation=true


### Hikari
spring.datasource.hikari.pool-name=MaplDB-Pool
spring.datasource.hikari.maximum-pool-size=5
spring.datasource.hikari.data-source-properties.cachePrepStmts=true
spring.datasource.hikari.data-source-properties.prepStmtCacheSize=250
spring.datasource.hikari.data-source-properties.prepStmtCacheSqlLimit=2048
spring.datasource.hikari.data-source-properties.useServerPrepStmts=true
spring.datasource.hikari.data-source-properties.useLocalSessionState=true
spring.datasource.hikari.data-source-properties.rewriteBatchedStatements=true
spring.datasource.hikari.data-source-properties.cacheResultSetMetadata=true
spring.datasource.hikari.data-source-properties.cacheServerConfiguration=true
spring.datasource.hikari.data-source-properties.elideSetAutoCommits=true
spring.datasource.hikari.data-source-properties.maintainTimeStats=false
#
##
## MIGRATIONS
spring.flyway.enabled=false
#spring.flyway.baseline-on-migrate=true
#spring.flyway.baseline-version=1
#spring.flyway.baseline-description=Baseline
#spring.flyway.locations=classpath:db/migration
#spring.flyway.schemas=public
#spring.flyway.table=schema_version
#spring.flyway.out-of-order=true
#spring.flyway.validate-on-migrate=true
#spring.flyway.clean-disabled=true

########## Docker #################################################
#/connect todos-user@localhost:3306
#docker run --detach
#--env MYSQL_ROOT_PASSWORD=dummypassword
#--env MYSQL_USER=todos-user
#--env MYSQL_PASSWORD=dummytodos
#--env MYSQL_DATABASE=todos
#--name mysql
#--publish 3306:3306
#mysql:8-oracle



